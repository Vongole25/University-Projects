{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a63903dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 모듈 import part"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "97c0b19a",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8536eb3",
   "metadata": {},
   "outputs": [],
   "source": [
    "import plotly.express as px\n",
    "import plotly.graph_objects as go"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "499d5acd",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 사진 고해상도로 저장하기 위한 패키지\n",
    "!pip install kaleido"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "374c7670",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ae9d18dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d359cbb9",
   "metadata": {},
   "outputs": [],
   "source": [
    "!pip install openpyxl"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2d14ec78",
   "metadata": {},
   "source": [
    "# 데이터 불러오기"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fcca9333",
   "metadata": {},
   "outputs": [],
   "source": [
    "path = \"C:/Users/cbskust/Desktop/학교/다차원자료분석PBL 기말고사/샘플데이터.txt\"\n",
    "origin_data = pd.read_csv(path, delim_whitespace=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b8298206",
   "metadata": {},
   "source": [
    "# 서울 지역 데이터만 추출"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "66ec498a",
   "metadata": {},
   "outputs": [],
   "source": [
    "origin_data.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4a2defe9",
   "metadata": {},
   "outputs": [],
   "source": [
    "origin_data['SIDO_NM'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1926bb56",
   "metadata": {},
   "outputs": [],
   "source": [
    "origin_data.groupby('SIDO_NM').size()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cd9b281b",
   "metadata": {},
   "outputs": [],
   "source": [
    "total = 0\n",
    "for i in range(len(origin_data.groupby('SIDO_NM').size())):\n",
    "    total += origin_data.groupby('SIDO_NM').size()[i]\n",
    "    \n",
    "print(total)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7f73c888",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 시도별 행 개수 막대그래프\n",
    "count_by_sido = origin_data.groupby('SIDO_NM').size().reset_index(name='row_num')\n",
    "\n",
    "fig = px.bar(count_by_sido, x='SIDO_NM', y='row_num', title='시도별 행의 개수')\n",
    "fig.write_image(\"1.png\", scale = 3)\n",
    "fig.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af7a2009",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 17개 시도별 면적\n",
    "area = [16830.8, 10199.7, 10542.5, 18424.1, 501, 1499.5, 539.8, 771.3, 605.2, 465, 1062.8, 1067.1, 12362.3, 8073.3, 1850.3, 8247.5, 7407]\n",
    "count_by_sido_area = count_by_sido.copy()\n",
    "\n",
    "# 단위면적당 시도별 행 개수 구하기\n",
    "for i in range(17):\n",
    "    count_by_sido_area['row_num'][i] = count_by_sido['row_num'][i] / area[i]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "77e53ea2",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 시도별 행 개수(단위면적당) 막대그래프\n",
    "\n",
    "fig = px.bar(count_by_sido_area, x='SIDO_NM', y='row_num', title='시도별 행의 개수(단위 면적 당)')\n",
    "fig.write_image(\"2.png\", scale = 3)\n",
    "fig.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8a100e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "seoul_data = origin_data[origin_data['SIDO_NM'] == '서울']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a52fbf88",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 데이터의 인덱스 1 ~ 64799로 조정\n",
    "seoul_data.index = range(1, len(seoul_data) + 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bbd10bf1",
   "metadata": {},
   "outputs": [],
   "source": [
    "seoul_data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "32f52191",
   "metadata": {},
   "source": [
    "# 변수 선택 및 결측치 처리"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a65d5044",
   "metadata": {},
   "source": [
    "## 위치정보 변수"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "609412ca",
   "metadata": {},
   "outputs": [],
   "source": [
    "location_info = ['PNU_CD', 'LEGALDONG_CD', 'SIGNGU_NM', 'LEGALDONG_NM', 'HMNO', 'VCNO', 'XCRDT', 'YCRDT']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "428cb30c",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_loc = seoul_data[location_info]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d7214df9",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_loc.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "96482db5",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_loc"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9186e405",
   "metadata": {},
   "source": [
    "## 토지이용상황코드 & 개별공시지가"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4d0fe092",
   "metadata": {},
   "outputs": [],
   "source": [
    "tozi_gongsi = ['LAND_USE_STTN_CD', 'OSILP']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8b08438",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_tozigongsi = seoul_data[tozi_gongsi]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3dd2b48a",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_tozigongsi.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "804247da",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_tozigongsi"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b0a127a4",
   "metadata": {},
   "source": [
    "## 인구관련 변수"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c1259500",
   "metadata": {},
   "outputs": [],
   "source": [
    "human = ['TOTPUL_CNT_ONE_KM', 'AGDX_ONE_KM', 'WKAGEPUL_CNT_ONE_KM', 'TOTHOHLD_CNT_ONE_KM']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "27a03e35",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_human = seoul_data[human]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "885f0827",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_human.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5dcb0ee3",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_human"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c701291",
   "metadata": {},
   "source": [
    "### 노령화지수_1km 결측값인 행의 index 추출"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b6954a39",
   "metadata": {},
   "outputs": [],
   "source": [
    "null_human = tmp_data_human[tmp_data_human['AGDX_ONE_KM'].isnull()].index\n",
    "null_human"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "82ed538c",
   "metadata": {},
   "source": [
    "## 경제활동"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a848e6f",
   "metadata": {},
   "outputs": [],
   "source": [
    "eco = ['TOTBS_CNT_ONE_KM', 'TOTENFSN_CNT_ONE_KM']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6f771784",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_eco = seoul_data[eco]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a416e34e",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_eco.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cd58afc5",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_eco"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5642a3c9",
   "metadata": {},
   "source": [
    "## 건물"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d2ac27cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "arch = ['BULD_CNT_ONE_KM', 'HOUSE_CNT_ONE_KM', 'OLDBLD_CNT_ONE_KM', 'OLDHS_CNT_ONE_KM', 'LDUSE_BULD_CMPDGR_ONE_KM', 'LDUSE_BULD_CMPLXDGR_ONE_KM']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95bf27d0",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_arch = seoul_data[arch]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4a4733c8",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_arch.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f864df4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_arch"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "48c7780c",
   "metadata": {},
   "source": [
    "## 교통"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "28f84766",
   "metadata": {},
   "outputs": [],
   "source": [
    "traffic = ['TFCVN_NRBHW_ECNT_FVHD_METER', 'TFCVN_HIWY_SHRTDST',\n",
    "          'TFCVN_NRBMARD_ECNT_FVHD_METER', 'TFCVN_MARD_SHRTDST',\n",
    "          'TFCVN_NRBSMRD_ECNT_FVHD_METER', 'TFCVN_SMRD_SHRTDST',\n",
    "          'TFCVN_NRBSRT_ECNT_FVHD_METER', 'TFCVN_STRT_SHRTDST',\n",
    "          'TFCVN_BSTP_CNT_ONE_KM', 'TFCVN_BSTP_SHRTDST',\n",
    "          'TFCVN_STATN_SHRTDST', \n",
    "          'TFCVN_HWIC_SHRTDST']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "94d5febb",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic = seoul_data[traffic]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7258ebfb",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ca5700ea",
   "metadata": {},
   "source": [
    "### 교통 관련 변수 결측값 처리 & effect 변수 만들기"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "90cc2b16",
   "metadata": {},
   "source": [
    "#### 고속도로 최단거리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f867ca0",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['TFCVN_HIWY_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "48c4bae9",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 박스 플롯\n",
    "fig1 = go.Figure()\n",
    "\n",
    "fig1.add_trace(go.Box(y=tmp_data_traffic['TFCVN_HIWY_SHRTDST'], name='고속도로 최단거리', boxpoints='all', jitter=0.3, pointpos=-1.8))\n",
    "\n",
    "fig1.update_layout(title='BOX PLOT')\n",
    "fig1.write_image(\"box_plot.png\", scale = 3)\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4fe8c89b",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['TFCVN_HIWY_SHRTDST'].fillna(501, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4d0eca9b",
   "metadata": {},
   "outputs": [],
   "source": [
    "x = tmp_data_traffic.loc[:, 'TFCVN_HIWY_SHRTDST']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "99c872d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['HIWY_EFFECT'] = 100 / 501 * (501 - x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba4f0a72",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 히스토그램\n",
    "fig1 = px.histogram(tmp_data_traffic, x='HIWY_EFFECT', nbins=30, title='HIWY_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "03510e05",
   "metadata": {},
   "source": [
    "#### 대로_최단거리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6d39f45f",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['TFCVN_MARD_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f2500cd0",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['TFCVN_MARD_SHRTDST'].fillna(501, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "afc7f7cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "x = tmp_data_traffic.loc[:, 'TFCVN_MARD_SHRTDST']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82fc1d9d",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['MARD_EFFECT'] = 100 / 501 * (501 - x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6046b49e",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# 히스토그램\n",
    "fig1 = px.histogram(tmp_data_traffic, x='MARD_EFFECT', nbins=30, title='MARD_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "078eac8f",
   "metadata": {},
   "source": [
    "#### 로_최단거리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5726c670",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['TFCVN_SMRD_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "89c83642",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['TFCVN_SMRD_SHRTDST'].fillna(501, inplace = True)\n",
    "x = tmp_data_traffic.loc[:, 'TFCVN_SMRD_SHRTDST']# 히스토그램\n",
    "tmp_data_traffic['SMRD_EFFECT'] = 100 / 501 * (501 - x)\n",
    "fig1 = px.histogram(tmp_data_traffic, x='SMRD_EFFECT', nbins=30, title='로_EFFECT HISTOGRAM')\n",
    "fig1.write_image(\"effect_histogram.png\", scale = 3)\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e3224c60",
   "metadata": {},
   "source": [
    "#### 길_최단거리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "acbdec70",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['TFCVN_STRT_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "78dd3190",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['TFCVN_STRT_SHRTDST'].fillna(501, inplace = True)\n",
    "x = tmp_data_traffic.loc[:, 'TFCVN_STRT_SHRTDST']# 히스토그램\n",
    "tmp_data_traffic['STRT_EFFECT'] = 100 / 501 * (501 - x)\n",
    "fig1 = px.histogram(tmp_data_traffic, x='STRT_EFFECT', nbins=30, title='STRT_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4ef38832",
   "metadata": {},
   "source": [
    "#### 정류장_최단거리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f127726e",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['TFCVN_BSTP_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49356dfc",
   "metadata": {},
   "outputs": [],
   "source": [
    "fig1 = px.histogram(tmp_data_traffic, x='TFCVN_BSTP_SHRTDST', nbins=30, title='BSTP_SHRTDST HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "87b9c48d",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic['TFCVN_BSTP_SHRTDST'].fillna(501, inplace = True)\n",
    "x = tmp_data_traffic.loc[:, 'TFCVN_BSTP_SHRTDST']# 히스토그램\n",
    "tmp_data_traffic['BSTP_EFFECT'] = 100 / 679 * (680 - x)\n",
    "fig1 = px.histogram(tmp_data_traffic, x='BSTP_EFFECT', nbins=30, title='BSTP_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "94a97c7c",
   "metadata": {},
   "outputs": [],
   "source": [
    "traffic_selected = ['TFCVN_NRBMARD_ECNT_FVHD_METER', 'MARD_EFFECT',\n",
    "                   'TFCVN_NRBSMRD_ECNT_FVHD_METER', 'SMRD_EFFECT',\n",
    "                   'TFCVN_BSTP_CNT_ONE_KM', 'BSTP_EFFECT']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1ec43ffe",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic_selected = tmp_data_traffic[traffic_selected]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "56f96a41",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_traffic_selected"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b8f48c68",
   "metadata": {},
   "source": [
    "## 생활편의시설"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d13cf52",
   "metadata": {},
   "outputs": [],
   "source": [
    "conv = ['LVCNS_ELESCH_SHRTDST', 'LVCNS_MSKUL_SHRTDST', 'LVCNS_HGSCHL_SHRTDST',\n",
    "       'LVCNS_INSTUT_CNT_ONE_KM', 'LVCNS_CLNCHSPTL_CNT_ONE_KM', 'LVCNS_BANK_CNT_ONE_KM',\n",
    "       'LVCNS_MARTDMST_CNT_ONE_KM', 'LVCNS_PBPACFCT_CNT_ONE_KM', 'LVCNS_CVST_CNT_ONE_KM']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7d6ce66d",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv = seoul_data[conv]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af002677",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a41f2c29",
   "metadata": {},
   "source": [
    "### effect 변수 만들기"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3eda7e3e",
   "metadata": {},
   "source": [
    "#### 초등학교 최단거리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e34fe948",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv['LVCNS_ELESCH_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b896508e",
   "metadata": {},
   "outputs": [],
   "source": [
    "fig1 = px.histogram(tmp_data_conv, x='LVCNS_ELESCH_SHRTDST', nbins=30, title='ELEMENT SCHOOL SHRTDST HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6b2d3ab6",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv['LVCNS_ELESCH_SHRTDST']\n",
    "x = tmp_data_conv.loc[:, 'LVCNS_ELESCH_SHRTDST']# 히스토그램\n",
    "tmp_data_conv['ELEMENT_EFFECT'] = 100 / 1984 * (1984 - x)\n",
    "fig1 = px.histogram(tmp_data_conv, x='ELEMENT_EFFECT', nbins=30, title='ELEMENT_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5d491bb5",
   "metadata": {},
   "source": [
    "#### 중학교 최단거리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c7e9ba14",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv['LVCNS_MSKUL_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3ff628b5",
   "metadata": {},
   "outputs": [],
   "source": [
    "fig1 = px.histogram(tmp_data_conv, x='LVCNS_MSKUL_SHRTDST', nbins=30, title='MIDDLE SCHOOL SHRTDST HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b773147",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv['LVCNS_MSKUL_SHRTDST']\n",
    "x = tmp_data_conv.loc[:, 'LVCNS_MSKUL_SHRTDST']# 히스토그램\n",
    "tmp_data_conv['MIDDLE_EFFECT'] = 100 / 2103 * (2103 - x)\n",
    "fig1 = px.histogram(tmp_data_conv, x='MIDDLE_EFFECT', nbins=30, title='MIDDLE_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1d64b87a",
   "metadata": {},
   "source": [
    "#### 고등학교 최단거리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d5357486",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv['LVCNS_HGSCHL_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "91b06e87",
   "metadata": {},
   "outputs": [],
   "source": [
    "fig1 = px.histogram(tmp_data_conv, x='LVCNS_HGSCHL_SHRTDST', nbins=30, title='HIGH SCHOOL SHRTDST HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9bb31632",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv['LVCNS_HGSCHL_SHRTDST']\n",
    "x = tmp_data_conv.loc[:, 'LVCNS_HGSCHL_SHRTDST']# 히스토그램\n",
    "tmp_data_conv['HIGH_EFFECT'] = 100 / 2103 * (2103 - x)\n",
    "fig1 = px.histogram(tmp_data_conv, x='HIGH_EFFECT', nbins=30, title='HIGH_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed537777",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "62354f93",
   "metadata": {},
   "outputs": [],
   "source": [
    "conv_selected = ['ELEMENT_EFFECT', 'MIDDLE_EFFECT', 'HIGH_EFFECT',\n",
    "                'LVCNS_INSTUT_CNT_ONE_KM', 'LVCNS_CLNCHSPTL_CNT_ONE_KM', 'LVCNS_BANK_CNT_ONE_KM',\n",
    "                'LVCNS_MARTDMST_CNT_ONE_KM', 'LVCNS_PBPACFCT_CNT_ONE_KM', 'LVCNS_CVST_CNT_ONE_KM']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8927e4fd",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv_selected = tmp_data_conv[conv_selected]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5eb5d599",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_conv_selected"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d513f8f",
   "metadata": {},
   "source": [
    "## 유해시설"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "96ea8273",
   "metadata": {},
   "outputs": [],
   "source": [
    "harm = ['HMFNFCT_PWPLNT_SHRTDST', 'HMFNFCT_CMTYFCT_SHRTDST', 'HMFNFCT_ESRNFCT_SHRTDST', 'HMFNFCT_WSTFCT_SHRTDST']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "274b3c5c",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm = seoul_data[harm]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5d2a66f",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "040bb4af",
   "metadata": {},
   "source": [
    "### effect 변수 만들기"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b92143f9",
   "metadata": {},
   "source": [
    "#### 발전소"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "76330652",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm['HMFNFCT_PWPLNT_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61f92a5c",
   "metadata": {},
   "outputs": [],
   "source": [
    "fig1 = px.histogram(tmp_data_harm, x='HMFNFCT_PWPLNT_SHRTDST', nbins=30, title='발전소 SHRTDST HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0638557",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm['HMFNFCT_PWPLNT_SHRTDST'].fillna(10001, inplace = True)\n",
    "x = tmp_data_harm.loc[:, 'HMFNFCT_PWPLNT_SHRTDST']# 히스토그램\n",
    "tmp_data_traffic['POWER_PLANT_EFFECT'] = 100 / 5044 * (10001 - x)\n",
    "fig1 = px.histogram(tmp_data_traffic, x='POWER_PLANT_EFFECT', nbins=30, title='POWER_PLANT_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1f39d47a",
   "metadata": {},
   "source": [
    "#### 화장시설"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4991539",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm['HMFNFCT_CMTYFCT_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c42d25b4",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "fig1 = px.histogram(tmp_data_harm, x='HMFNFCT_CMTYFCT_SHRTDST', nbins=30, title='화장시설 SHRTDST HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "649f79ae",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "tmp_data_harm['HMFNFCT_CMTYFCT_SHRTDST'].fillna(10001, inplace = True)\n",
    "x = tmp_data_harm.loc[:, 'HMFNFCT_CMTYFCT_SHRTDST']# 히스토그램\n",
    "tmp_data_harm['CREMATORY_EFFECT'] = 100 / 9976 * (10001 - x)\n",
    "fig1 = px.histogram(tmp_data_traffic, x='CREMATORY_EFFECT', nbins=30, title='CREMATORY_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8dcbf597",
   "metadata": {},
   "source": [
    "#### 봉안시설"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cea07d34",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm['HMFNFCT_ESRNFCT_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5cdbbbbd",
   "metadata": {},
   "outputs": [],
   "source": [
    "fig1 = px.histogram(tmp_data_harm, x='HMFNFCT_ESRNFCT_SHRTDST', nbins=30, title='봉안시설 SHRTDST HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cd647d40",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm['HMFNFCT_ESRNFCT_SHRTDST']\n",
    "x = tmp_data_harm.loc[:, 'HMFNFCT_ESRNFCT_SHRTDST']# 히스토그램\n",
    "tmp_data_harm['COLUMBARIUM_EFFECT'] = 100 / 7636 * (7637 - x)\n",
    "fig1 = px.histogram(tmp_data_traffic, x='COLUMBARIUM_EFFECT', nbins=30, title='COLUMBARIUM_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4c602763",
   "metadata": {},
   "source": [
    "#### 폐기물시설"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f355338c",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm['HMFNFCT_WSTFCT_SHRTDST'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1977c05b",
   "metadata": {},
   "outputs": [],
   "source": [
    "fig1 = px.histogram(tmp_data_harm, x='HMFNFCT_WSTFCT_SHRTDST', nbins=30, title='폐기물시설 SHRTDST HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "945822ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm['HMFNFCT_WSTFCT_SHRTDST']\n",
    "x = tmp_data_harm.loc[:, 'HMFNFCT_WSTFCT_SHRTDST']# 히스토그램\n",
    "tmp_data_harm['WASTE_EFFECT'] = 100 / 6924 * (6926 - x)\n",
    "fig1 = px.histogram(tmp_data_traffic, x='WASTE_EFFECT', nbins=30, title='WASTE_EFFECT HISTOGRAM')\n",
    "fig1.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bf2a5e82",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce90be0d",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm.drop(columns = ['HMFNFCT_CMTYFCT_SHRTDST', 'HMFNFCT_ESRNFCT_SHRTDST', 'HMFNFCT_WSTFCT_SHRTDST'], inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "254c7ea6",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp_data_harm"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a67d19e2",
   "metadata": {},
   "source": [
    "# 데이터 합치기"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5310d396",
   "metadata": {},
   "source": [
    "tmp_data_loc\n",
    "\n",
    "tmp_data_tozigongsi\n",
    "\n",
    "tmp_data_human\n",
    "\n",
    "tmp_data_eco\n",
    "\n",
    "tmp_data_arch\n",
    "\n",
    "tmp_data_traffic_selected\n",
    "\n",
    "tmp_data_conv_selected\n",
    "\n",
    "tmp_data_harm\n",
    "\n",
    "-> 얘네를 합치면 됨"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6b1a0333",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_merged = pd.concat([tmp_data_loc, tmp_data_tozigongsi, tmp_data_human, tmp_data_eco, \n",
    "                         tmp_data_arch, tmp_data_traffic_selected, tmp_data_conv_selected, tmp_data_harm], axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4a55e1b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_merged"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "266811ac",
   "metadata": {},
   "source": [
    "## 결측치 제거"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "64ba2eb8",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_merged.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "064d2298",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_final = data_merged.drop(index = 35237)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1787aef0",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_final.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "86c0576e",
   "metadata": {},
   "source": [
    "## 열 이름 변경"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b3ed2299",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_column_names = ['PNU', 'DONG_CODE', 'SIGUNGU_NAME', 'DONG_NAME', 'BON', 'BU', 'X', 'Y',\n",
    "                   'LAND_USE_CODE', 'PRICE',\n",
    "                   'TOTAL_POP', 'OLD_IDX', 'WORKABLE_POP', 'HOUSEHOLD_N',\n",
    "                   'TOTAL_BUISNESS', 'TOTAL_WORKER',\n",
    "                   'BUILDING', 'HOUSE', 'OLD_BUILDING', 'OLD_HOUSE', 'BUILDING_DENSITY', 'BUILDING_COMPLEXITY',\n",
    "                   'BIGROAD_N', 'BIGROAD_EFFECT', 'ROAD_N', 'ROAD_EFFECT', 'BUS_N', 'BUS_EFFECT',\n",
    "                   'ELEMENT_EFFECT', 'MIDDLE_EFFECT', 'HIGH_EFFECT', 'ACADEMY', 'HOSPITAL', 'BANK', 'MART_DEPARTMENT', 'SECURITY', 'CONVENIENT',\n",
    "                   'CREMATORIUM_EFFECT', 'COLUMBARIUM_EFFECT', 'WASTE_EFFECT']\n",
    "data_final.columns = new_column_names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e3b212a8",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_final.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2b492a3e",
   "metadata": {},
   "source": [
    "## 데이터 csv와 엑셀 형식으로 저장"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fb8505e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_final.to_csv('C:/Users/cbskust/Dropbox/교과/다차원자료분석PBL/기말고사/데이터/data.csv', index = False, encoding = 'utf-8-sig')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d228d143",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_final.to_excel('C:/Users/cbskust/Dropbox/교과/다차원자료분석PBL/기말고사/데이터/data.xlsx', index = False, engine = 'openpyxl')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "92a41aa5",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.10"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {
    "height": "calc(100% - 180px)",
    "left": "10px",
    "top": "150px",
    "width": "349.716px"
   },
   "toc_section_display": true,
   "toc_window_display": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
